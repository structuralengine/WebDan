<div *ngIf="isLoading" class="spinner-border" style="width: 1rem; height: 1rem;" role="status">
  <span class="sr-only">Loading...</span>
</div>

<ng-container *ngIf="!isLoading">
  <ng-container *ngIf="isFulfilled">
    <div id="ap_0"></div>

    <ng-container *ngFor="let page of pages">
      <section class="sheet">
        <h3 class="h3">{{ page.g_name }}</h3>

        <ng-container *ngIf="page.tableType == 1">
          <ng-container *ngFor="let table of page.tables">
            <svg width="568" [attr.height]="table.viewBox.height" [attr.viewBox]="table.viewBox" xmlns="http://www.w3.org/2000/svg"
              xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
              <!--タイトル-->
              <text x="0" y="11" font-size="10pt" text-anchor="start">
                {{ table.title }}
              </text>

              <!--column Header-->
              <g font-size="10pt" text-anchor="middle">
                <text x="12" y="27">部材</text>
                <text x="12" y="43">番号</text>
                <text x="39" y="27">算出</text>
                <text x="39" y="43">番号</text>

                <text x="85" y="27">算出点</text>
                <text x="155" y="27">算 出 点 名</text>
                <text x="299" y="27">上　　 側</text>
                <text x="470" y="27">下　　 側</text>
                <text x="235" y="44">M</text>
                <text x="265" y="44">(kN･m)</text>
                <text x="303" y="44">N</text>
                <text x="333" y="44">(kN)</text>
                <text x="371" y="44">comb</text>
                <text x="401" y="44">M</text>
                <text x="432" y="44">(kN･m)</text>
                <text x="470" y="44">N</text>
                <text x="500" y="44">(kN)</text>
                <text x="545" y="44">comb</text>
              </g>
              <!--横線
              <g fill="none" stroke="black">
                <line stroke-width="0.35" x1="0" y1="12" x2="568" y2="12" />
                <line stroke-width="0.20" x1="59" y1="31" x2="568" y2="31" />
                <line stroke-width="0.35" x1="0" y1="72" x2="568" y2="72" />
              </g>
-->
              <ng-container *ngFor="let row of table.rows; index as r">
                <!--横線
                <g fill="none" stroke="black">
                  <line stroke-width="0.20" x1="0" [attr.y1]="27 + r * 16" x2="150" [attr.y2]="27 + r * 16" />
                </g>
                -->
                <!--column Header-->
                <g font-size="10pt">
                  <text x="12" [attr.y]="60 + r * 16" text-anchor="middle">
                    {{ row.m_no }}
                  </text>
                  <text x="42" [attr.y]="60 + r * 16" text-anchor="middle">
                    {{ row.p_name }}
                  </text>
                  <text x="105" [attr.y]="60 + r * 16" text-anchor="end">
                    {{ row.position }}
                  </text>
                  <text x="115" [attr.y]="60 + r * 16" text-anchor="start">
                    {{ row.p_name_ex }}
                  </text>
                  <text x="265" [attr.y]="60 + r * 16" text-anchor="end">
                    {{ row.upper.Md }}
                  </text>
                  <text x="333" [attr.y]="60 + r * 16" text-anchor="end">
                    {{ row.upper.Nd }}
                  </text>
                  <text x="371" [attr.y]="60 + r * 16" text-anchor="middle">
                    {{ row.upper.comb }}
                  </text>
                  <text x="432" [attr.y]="60 + r * 16" text-anchor="end">
                    {{ row.lower.Md }}
                  </text>
                  <text x="500" [attr.y]="60 + r * 16" text-anchor="end">
                    {{ row.lower.Nd }}
                  </text>
                  <text x="545" [attr.y]="60 + r * 16" text-anchor="middle">
                    {{ row.lower.comb }}
                  </text>
                </g>
              </ng-container>

              <!--縦線-->
              <g fill="none" stroke="black">
                <line stroke-width="0.20" x1="27"  y1="19" x2="27"  [attr.y2]="51 + table.rows.length * 16" />
                <line stroke-width="0.20" x1="54"  y1="19" x2="54"  [attr.y2]="51 + table.rows.length * 16" />
                <line stroke-width="0.20" x1="110" y1="19" x2="110" [attr.y2]="51 + table.rows.length * 16" />
                <line stroke-width="0.35" x1="210" y1="19" x2="210" [attr.y2]="51 + table.rows.length * 16" />
                <line stroke-width="0.20" x1="280" y1="35" x2="280" [attr.y2]="51 + table.rows.length * 16" />
                <line stroke-width="0.20" x1="350" y1="35" x2="350" [attr.y2]="51 + table.rows.length * 16" />
                <line stroke-width="0.35" x1="385" y1="19" x2="385" [attr.y2]="51 + table.rows.length * 16" />
                <line stroke-width="0.20" x1="455" y1="35" x2="455" [attr.y2]="51 + table.rows.length * 16" />
                <line stroke-width="0.20" x1="525" y1="35" x2="525" [attr.y2]="51 + table.rows.length * 16" /> 
              </g>

            </svg>
          </ng-container>
        </ng-container>

        <ng-container *ngIf="page.tableType == 2">
          <ng-container *ngFor="let table of page.tables">
            <svg width="568" [attr.height]="table.viewBox.height" [attr.viewBox]="table.viewBox"
              xmlns="http://www.w3.org/2000/svg"
              xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
              <!--タイトル-->
              <text x="0" y="11" font-size="10pt" text-anchor="start">
                {{ table.title }}
              </text>

              <!--column Header-->
              <g font-size="10pt" text-anchor="middle">
                <text x="4" y="16">部材</text>
                <text x="4" y="20">番号</text>
                <text x="13" y="16">算出</text>
                <text x="13" y="20">番号</text>

                <text x="26" y="16">算出点</text>
                <text x="43" y="16">算 出 点 名</text>
                <text x="86" y="16">上　　 側</text>
                <text x="149" y="16">下　　 側</text>

                <text x="58" y="21">V</text>
                <text x="66" y="21">(kN)</text>
                <text x="76" y="21">M</text>
                <text x="84" y="21">(kN･m)</text>
                <text x="94" y="21">N</text>
                <text x="102" y="21">(kN)</text>
                <text x="113" y="21">comb</text>

                <text x="121" y="21">V</text>
                <text x="129" y="21">(kN)</text>
                <text x="139" y="21">M</text>
                <text x="147" y="21">(kN･m)</text>
                <text x="157" y="21">N</text>
                <text x="165" y="21">(kN)</text>
                <text x="176" y="21">comb</text>

              </g>
              <!--横線-->
              <g fill="none" stroke="black">
                <line stroke-width="0.35" x1="0" y1="12" x2="180" y2="12" />
                <line stroke-width="0.20" x1="54" y1="17" x2="180" y2="17" />
                <line stroke-width="0.35" x1="0" y1="22" x2="180" y2="22" />
              </g>

              <ng-container *ngFor="let row of table.rows; index as r">
                <!--横線-->
                <g fill="none" stroke="black">
                  <line stroke-width="0.20" x1="0" [attr.y1]="27 + r * 16" x2="180" [attr.y2]="27 + r * 16" />
                </g>
                <!--column Header-->
                <g font-size="10pt">
                  <text x="5" [attr.y]="26 + r * 16" text-anchor="middle">
                    {{ row.m_no }}
                  </text>
                  <text x="13" [attr.y]="26 + r * 16" text-anchor="middle">
                    {{ row.p_name }}
                  </text>
                  <text x="30" [attr.y]="26 + r * 16" text-anchor="end">
                    {{ row.position }}
                  </text>
                  <text x="35" [attr.y]="26 + r * 16" text-anchor="start">
                    {{ row.p_name_ex }}
                  </text>
                  <text x="70" [attr.y]="26 + r * 16" text-anchor="end">
                    {{ row.upper.Vd }}
                  </text>
                  <text x="88" [attr.y]="26 + r * 16" text-anchor="end">
                    {{ row.upper.Md }}
                  </text>
                  <text x="106" [attr.y]="26 + r * 16" text-anchor="end">
                    {{ row.upper.Nd }}
                  </text>
                  <text x="113" [attr.y]="26 + r * 16" text-anchor="middle">
                    {{ row.upper.comb }}
                  </text>
                  <text x="133" [attr.y]="26 + r * 16" text-anchor="end">
                    {{ row.lower.Vd }}
                  </text>
                  <text x="151" [attr.y]="26 + r * 16" text-anchor="end">
                    {{ row.lower.Md }}
                  </text>
                  <text x="169" [attr.y]="26 + r * 16" text-anchor="end">
                    {{ row.lower.Nd }}
                  </text>
                  <text x="176" [attr.y]="26 + r * 16" text-anchor="middle">
                    {{ row.lower.comb }}
                  </text>
                </g>
              </ng-container>

              <!--縦線-->
              <g fill="none" stroke="black">
                <line stroke-width="0.20" x1="7" y1="12" x2="7" [attr.y2]="23 + table.rows.length * 16" />
                <line stroke-width="0.20" x1="19" y1="12" x2="19" [attr.y2]="23 + table.rows.length * 16" />
                <line stroke-width="0.20" x1="33" y1="12" x2="33" [attr.y2]="23 + table.rows.length * 16" />
                <line stroke-width="0.35" x1="54" y1="12" x2="54" [attr.y2]="23 + table.rows.length * 16" />
                <line stroke-width="0.20" x1="72" y1="17" x2="72" [attr.y2]="23 + table.rows.length * 16" />
                <line stroke-width="0.20" x1="90" y1="17" x2="90" [attr.y2]="23 + table.rows.length * 16" />
                <line stroke-width="0.20" x1="108" y1="17" x2="108" [attr.y2]="23 + table.rows.length * 16" />
                <line stroke-width="0.35" x1="117" y1="12" x2="117" [attr.y2]="23 + table.rows.length * 16" />
                <line stroke-width="0.20" x1="135" y1="17" x2="135" [attr.y2]="23 + table.rows.length * 16" />
                <line stroke-width="0.20" x1="153" y1="17" x2="153" [attr.y2]="23 + table.rows.length * 16" />
                <line stroke-width="0.20" x1="171" y1="17" x2="171" [attr.y2]="23 + table.rows.length * 16" />
              </g>
            </svg>
          </ng-container>
        </ng-container>

      </section>
    </ng-container>

  </ng-container>
</ng-container>